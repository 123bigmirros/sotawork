{"cmd": "import hmac\nfrom hashlib import sha1\nimport base64\nimport time\nimport uuid\n\ndef make_sign():\n    \"\"\"\n    生成签名\n    \"\"\"\n\n    # API访问密钥\n    secret_key = 'isNsd1L9yfHLMM4MUks_NRQ7avMlP55J'\n    #/api/generate/webui/text2img\n    # 请求API接口的uri地址\n    # uri = \"/api/model/version/get\"\n    uri = \"/api/generate/webui/text2img\"\n    uri = \"/api/generate/webui/status\"\n    uri = \"/api/generate/webui/img2img\"\n    # 当前毫秒时间戳\n    timestamp = str(int(time.time() * 1000))\n    # 随机字符串\n    signature_nonce= str(uuid.uuid4())\n    # 拼接请求数据\n    content = '&'.join((uri, timestamp, signature_nonce))\n\n    # 生成签名\n    digest = hmac.new(secret_key.encode(), content.encode(), sha1).digest()\n    # 移除为了补全base64位数而填充的尾部等号\n    sign = base64.urlsafe_b64encode(digest).rstrip(b'=').decode()\n    result = f'?AccessKey=dJsFLZRidcsf1cSlBwzeSQ&Signature={sign}&Timestamp={timestamp}&SignatureNonce={signature_nonce}'\n    return result \nimport pyperclip  \npyperclip.copy(make_sign())", "cmd_opts": "", "import_complete": 1, "terminal": "nvimterm"}